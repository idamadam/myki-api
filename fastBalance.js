const rp = require('request-promise-native');
const cheerio = require('cheerio');

let loginForm = {
    __LASTFOCUS: '',
    __EVENTTARGET: '',
    __EVENTARGUMENT: '',
    __VIEWSTATE: '/wEPDwUKMTUwODg3NDI3Ng9kFgJmD2QWAgIDD2QWAgIBD2QWDAIBD2QWEmYPFgIeBGhyZWYFC34vaG9tZS5hc3B4ZAICDw8WAh4EVGV4dAUFTG9naW5kZAIDD2QWBGYPD2QWAh4Jb25rZXlkb3duBVZFbmFibGVFbnRlcigod2luZG93LmV2ZW50KSA/IHdpbmRvdy5ldmVudCA6IGFyZ3VtZW50c1swXSwnY3RsMDBfdXhIZWFkZXJfY3RsMDBfY3RsMDAnKWQCAg8QZGQWAWZkAgQPFgIeB29uY2xpY2sFEXtyZXR1cm4gUHJpbnQoKTt9ZAIFDxYEHgV0aXRsZQULTGFyZ2VyIFRleHQfAwUWe3JldHVybiBub3JtYWxGb250KCk7fWQCBg8PFgQeCEltYWdlVXJsBR5+L0luY2x1ZGUvSW1hZ2VzL2ljb25Mb2dpbi5naWYeB1Rvb2xUaXAFE0NsaWNrIGhlcmUgdG8gbG9naW5kZAIHDw8WAh8BZWRkAggPFgIeB1Zpc2libGVoZAIJD2QWAgIBDxYCHgNzcmMFGn4vSW5jbHVkZS9JbWFnZXMvbG9naW4uanBnZAIFD2QWAgIBEDwrAA0CAA8WAh4LXyFEYXRhQm91bmRnZAwUKwAJBR8wOjAsMDoxLDA6MiwwOjMsMDo0LDA6NSwwOjYsMDo3FCsAAhYOHwEFBEhvbWUeBVZhbHVlBQRIb21lHgtOYXZpZ2F0ZVVybAURfi8uLi9kZWZhdWx0LmFzcHgeB0VuYWJsZWRoHgpTZWxlY3RhYmxlZx4IRGF0YVBhdGgFIC8qW3Bvc2l0aW9uKCk9MV0vKltwb3NpdGlvbigpPTFdHglEYXRhQm91bmRnZBQrAAIWDh8BBQ9Ib3cgdG8gdXNlIG15a2kfCgUPSG93IHRvIHVzZSBteWtpHwsFIX4vLi4vSG93LXRvLXVzZS1teWtpL2RlZmF1bHQuYXNweB8MaB8NZx8OBSAvKltwb3NpdGlvbigpPTFdLypbcG9zaXRpb24oKT0yXR8PZxQrAAcFFzA6MCwwOjEsMDoyLDA6MywwOjQsMDo1FCsAAhYOHwEFCkFib3V0IG15a2kfCgUKQWJvdXQgbXlraR8LBSx+Ly4uL0hvdy10by11c2UtbXlraS9BYm91dC1teWtpL2RlZmF1bHQuYXNweB8MaB8NZx8OBTAvKltwb3NpdGlvbigpPTFdLypbcG9zaXRpb24oKT0yXS8qW3Bvc2l0aW9uKCk9MV0fD2dkFCsAAhYOHwEFClVzaW5nIG15a2kfCgUKVXNpbmcgbXlraR8LBSx+Ly4uL0hvdy10by11c2UtbXlraS9Vc2luZy1teWtpL2RlZmF1bHQuYXNweB8MaB8NZx8OBTAvKltwb3NpdGlvbigpPTFdLypbcG9zaXRpb24oKT0yXS8qW3Bvc2l0aW9uKCk9Ml0fD2dkFCsAAhYOHwEFClRoZSBmdXR1cmUfCgUKVGhlIGZ1dHVyZR8LBSt+L2NvbW1vbi9DTVMvVGhlRnV0dXJlLmFzcHg/bWVudT1UaGUgZnV0dXJlHwxoHw1nHw4FMC8qW3Bvc2l0aW9uKCk9MV0vKltwb3NpdGlvbigpPTJdLypbcG9zaXRpb24oKT0zXR8PZ2QUKwACFg4fAQUUTWFraW5nIG15a2kgeW91ciBrZXkfCgUUTWFraW5nIG15a2kgeW91ciBrZXkfCwU2fi8uLi9Ib3ctdG8tdXNlLW15a2kvTWFraW5nLW15a2kteW91ci1rZXkvZGVmYXVsdC5hc3B4HwxoHw1nHw4FMC8qW3Bvc2l0aW9uKCk9MV0vKltwb3NpdGlvbigpPTJdLypbcG9zaXRpb24oKT00XR8PZ2QUKwACFg4fAQUWSGVscGZ1bCB0aXBzIGFuZCBoaW50cx8KBRZIZWxwZnVsIHRpcHMgYW5kIGhpbnRzHwsFOH4vLi4vSG93LXRvLXVzZS1teWtpL0hlbHBmdWwtdGlwcy1hbmQtaGludHMvZGVmYXVsdC5hc3B4HwxoHw1nHw4FMC8qW3Bvc2l0aW9uKCk9MV0vKltwb3NpdGlvbigpPTJdLypbcG9zaXRpb24oKT01XR8PZ2QUKwACFg4fAQUJQWJvdXQgVFRBHwoFCUFib3V0IFRUQR8LBSt+Ly4uL0hvdy10by11c2UtbXlraS9BYm91dC1UVEEvZGVmYXVsdC5hc3B4HwxoHw1nHw4FMC8qW3Bvc2l0aW9uKCk9MV0vKltwb3NpdGlvbigpPTJdLypbcG9zaXRpb24oKT02XR8PZ2QUKwACFg4fAQUIR2V0IG15a2kfCgUIR2V0IG15a2kfCwUxfi9Db21tb24vZ2V0bXlraS9HZXRNeWtpT3B0aW9uLmFzcHg/bWVudT1HZXQgbXlraR8MZx8NZx8OBSAvKltwb3NpdGlvbigpPTFdLypbcG9zaXRpb24oKT0zXR8PZ2QUKwACFg4fAQULU2V0IHVwIG15a2kfCgULU2V0IHVwIG15a2kfCwUyfi9Db21tb24vYXV4aWxsYXJ5L3NldHVwbXlraS5hc3B4P21lbnU9U2V0IHVwIG15a2kfDGcfDWcfDgUgLypbcG9zaXRpb24oKT0xXS8qW3Bvc2l0aW9uKCk9NF0fD2cUKwAEBQswOjAsMDoxLDA6MhQrAAIWDh8BBQhBY3RpdmF0ZR8KBQhBY3RpdmF0ZR8LBTJ+L0NvbW1vbi9hdXhpbGxhcnkvQWN0aXZhdGVDYXJkLmFzcHg/bWVudT1BY3RpdmF0ZR8MaB8NZx8OBTAvKltwb3NpdGlvbigpPTFdLypbcG9zaXRpb24oKT00XS8qW3Bvc2l0aW9uKCk9MV0fD2dkFCsAAhYOHwEFCFJlZ2lzdGVyHwoFCFJlZ2lzdGVyHwsFNn4vQ29tbW9uL3JlZ2lzdGVyL1JlZ2lzdGVybXlraUFub255LmFzcHg/bWVudT1SZWdpc3Rlch8MZx8NZx8OBTAvKltwb3NpdGlvbigpPTFdLypbcG9zaXRpb24oKT00XS8qW3Bvc2l0aW9uKCk9Ml0fD2dkFCsAAhYOHwEFEVNldCB1cCB3ZWIgYWNjZXNzHwoFEVNldCB1cCB3ZWIgYWNjZXNzHwsFPH4vQ29tbW9uL3JlZ2lzdGVyL1NldHVwV2ViQWNjZXNzLmFzcHg/bWVudT1TZXQgdXAgd2ViIGFjY2Vzcx8MZx8NZx8OBTAvKltwb3NpdGlvbigpPTFdLypbcG9zaXRpb24oKT00XS8qW3Bvc2l0aW9uKCk9M10fD2dkFCsAAhYOHwEFC1RvcCB1cCBteWtpHwoFC1RvcCB1cCBteWtpHwsFPH4vQ29tbW9uL0Fub255bW91c1RvcFVwL2Fub255dG9wdXBteWtpLmFzcHg/bWVudT1Ub3AgdXAgbXlraR8MZx8NZx8OBSAvKltwb3NpdGlvbigpPTFdLypbcG9zaXRpb24oKT01XR8PZxQrAAIFAzA6MBQrAAIWDh8BBQ1DaG9vc2UgdG9wIHVwHwoFDUNob29zZSB0b3AgdXAfCwVAfi9Db21tb24vQW5vbnltb3VzVG9wVXAvYW5vbnlDaG9vc2VUb3BVcC5hc3B4P21lbnU9Q2hvb3NlIHRvcCB1cB8MZx8NZx8OBTAvKltwb3NpdGlvbigpPTFdLypbcG9zaXRpb24oKT01XS8qW3Bvc2l0aW9uKCk9MV0fD2dkFCsAAhYOHwEFFUNhcmQvQWNjb3VudCBSZXF1ZXN0cx8KBRVDYXJkL0FjY291bnQgUmVxdWVzdHMfCwU+fi9Db21tb24vQXV4aWxsYXJ5L0Zvcm1MaWJyYXJ5LmFzcHg/bWVudT1DYXJkL0FjY291bnQgUmVxdWVzdHMfDGcfDWcfDgUgLypbcG9zaXRpb24oKT0xXS8qW3Bvc2l0aW9uKCk9Nl0fD2cUKwAEBQswOjAsMDoxLDA6MhQrAAIWDh8BBRBBcHBseSBmb3IgcmVmdW5kHwoFEEFwcGx5IGZvciByZWZ1bmQfCwUlfi9Db21tb24vQ29tcGVuc2F0aW9uL1JlZnVuZG15a2kuYXNweB8MZx8NZx8OBTAvKltwb3NpdGlvbigpPTFdLypbcG9zaXRpb24oKT02XS8qW3Bvc2l0aW9uKCk9MV0fD2dkFCsAAhYOHwEFF0FwcGx5IGZvciByZWltYnVyc2VtZW50HwoFF0FwcGx5IGZvciByZWltYnVyc2VtZW50HwsFLH4vQ29tbW9uL0NvbXBlbnNhdGlvbi9SZWltYnVyc2VtZW50bXlraS5hc3B4HwxnHw1nHw4FMC8qW3Bvc2l0aW9uKCk9MV0vKltwb3NpdGlvbigpPTZdLypbcG9zaXRpb24oKT0yXR8PZ2QUKwACFg4fAQUMUmVwbGFjZSBteWtpHwoFDFJlcGxhY2UgbXlraR8LBSF+L0NvbW1vbi9SZXBsYWNlL1JlcGxhY2VNeWtpLmFzcHgfDGcfDWcfDgUwLypbcG9zaXRpb24oKT0xXS8qW3Bvc2l0aW9uKCk9Nl0vKltwb3NpdGlvbigpPTNdHw9nZBQrAAIWDh8BBRNDb21tdW5pdHkgZWR1Y2F0aW9uHwoFE0NvbW11bml0eSBlZHVjYXRpb24fCwUlfi8uLi9Db21tdW5pdHktZWR1Y2F0aW9uL2RlZmF1bHQuYXNweB8MaB8NZx8OBSAvKltwb3NpdGlvbigpPTFdLypbcG9zaXRpb24oKT03XR8PZxQrAAQFCzA6MCwwOjEsMDoyFCsAAhYOHwEFFkRpc2NvdmVyeSBjZW50cmUgZGlhcnkfCgUWRGlzY292ZXJ5IGNlbnRyZSBkaWFyeR8LBUh+L2NvbW1vbi9EaXNjb3ZlcnkvRGlzY292ZXJ5Q2VudGVyRGlhcnkuYXNweD9tZW51PURpc2NvdmVyeSBjZW50cmUgZGlhcnkfDGgfDWcfDgUwLypbcG9zaXRpb24oKT0xXS8qW3Bvc2l0aW9uKCk9N10vKltwb3NpdGlvbigpPTFdHw9nZBQrAAIWDh8BBRlCb29rIHRoZSBkaXNjb3ZlcnkgY2VudHJlHwoFGUJvb2sgdGhlIGRpc2NvdmVyeSBjZW50cmUfCwVKfi9jb21tb24vRGlzY292ZXJ5L0Jvb2tEaXNjb3ZlcnlDZW50ZXIuYXNweD9tZW51PUJvb2sgdGhlIGRpc2NvdmVyeSBjZW50cmUfDGgfDWcfDgUwLypbcG9zaXRpb24oKT0xXS8qW3Bvc2l0aW9uKCk9N10vKltwb3NpdGlvbigpPTJdHw9nZBQrAAIWDh8BBSVGdXR1cmUgbW9iaWxlIGRpc2NvdmVyeSBjZW50cmUgdmlzaXRzHwoFJUZ1dHVyZSBtb2JpbGUgZGlzY292ZXJ5IGNlbnRyZSB2aXNpdHMfCwVTfi9jb21tb24vRGlzY292ZXJ5L1ZpZXdGdXR1cmVWaXNpdHMuYXNweD9tZW51PUZ1dHVyZSBtb2JpbGUgZGlzY292ZXJ5IGNlbnRyZSB2aXNpdHMfDGgfDWcfDgUwLypbcG9zaXRpb24oKT0xXS8qW3Bvc2l0aW9uKCk9N10vKltwb3NpdGlvbigpPTNdHw9nZBQrAAIWDh8BBQpDb250YWN0IHVzHwoFCkNvbnRhY3QgdXMfCwUzfi9Db21tb24vQXV4aWxsYXJ5L0NvbnRhY3RpbmZvLmFzcHg/bWVudT1Db250YWN0IHVzHwxnHw1nHw4FIC8qW3Bvc2l0aW9uKCk9MV0vKltwb3NpdGlvbigpPThdHw9nFCsABQUPMDowLDA6MSwwOjIsMDozFCsAAhYOHwEFDENvbnRhY3QgbXlraR8KBQxDb250YWN0IG15a2kfCwUvfi9Db21tb24vQXV4aWxsYXJ5L0NvbnRhY3R1cy5hc3B4P21lbnU9RmVlZGJhY2sfDGcfDWcfDgUwLypbcG9zaXRpb24oKT0xXS8qW3Bvc2l0aW9uKCk9OF0vKltwb3NpdGlvbigpPTFdHw9nZBQrAAIWDh8BBRRDaGVjayBzdGF0dXMgcmVxdWVzdB8KBRRDaGVjayBzdGF0dXMgcmVxdWVzdB8LBUh+L0NvbW1vbi9BdXhpbGxhcnkvQW5vbnltb3VzUmVxdWVzdFN0YXR1cy5hc3B4P21lbnU9Q2hlY2sgc3RhdHVzIHJlcXVlc3QfDGgfDWcfDgUwLypbcG9zaXRpb24oKT0xXS8qW3Bvc2l0aW9uKCk9OF0vKltwb3NpdGlvbigpPTJdHw9nZBQrAAIWDh8BBQtTcG9uc29yc2hpcB8KBQtTcG9uc29yc2hpcB8LBSh+Ly4uL0NvbnRhY3QtdXMvU3BvbnNvcnNoaXAvZGVmYXVsdC5hc3B4HwxoHw1nHw4FMC8qW3Bvc2l0aW9uKCk9MV0vKltwb3NpdGlvbigpPThdLypbcG9zaXRpb24oKT0zXR8PZ2QUKwACFg4fAQUMT3VyIHBhcnRuZXJzHwoFDE91ciBwYXJ0bmVycx8LBSl+Ly4uL0NvbnRhY3QtdXMvT3VyLXBhcnRuZXJzL2RlZmF1bHQuYXNweB8MaB8NZx8OBTAvKltwb3NpdGlvbigpPTFdLypbcG9zaXRpb24oKT04XS8qW3Bvc2l0aW9uKCk9NF0fD2dkZGQCCQ9kFgQCAQ8WAh8BZWQCAg9kFgICBQ8PZBYCHwMFG3tyZXR1cm4gVmFsaWRhdGVCcm93c2VyKCk7fWQCCw9kFgICAQ8WAh8BBeUBPCEtLSBHZW5lcmF0ZWQgYnkgWFN0YW5kYXJkIHZlcnNpb24gMi4wLjAuMCBvbiAyMDEzLTEwLTI5VDEyOjIxOjUzIC0tPjxwPjxpbWcgYWx0PSJZb3UncmUgYWx3YXlzIHJlYWR5IHRvIHRyYXZlbCB3aXRoIG15a2kgYXV0byB0b3AgdXAuIiBoZWlnaHQ9IjI5OSIgaWQ9ImltZ19BZHZlcnRpc2UiIHJ1bmF0PSJzZXJ2ZXIiIHNyYz0ibXlraS1BdXRvLVRvcC1VcC5qcGciIHdpZHRoPSIxMzYiIC8+PC9wPmQCDQ9kFgICAQ8PFgIfB2hkFgpmDw8WAh8BZWRkAgIPEGRkFgFmZAIEDw9kFgIfAwUhe3JldHVybiBnZXRDb21hbmROYW1lKCdVcGRhdGUnKTt9ZAIFDw9kFgIfAwUhe3JldHVybiBnZXRDb21hbmROYW1lKCdTdWJtaXQnKTt9ZAIGDw9kFgIfAwUne3JldHVybiBDb25maXJtTmV3U2VhcmNoKCdOZXdTZWFyY2gnKTt9ZAIPD2QWAgIBD2QWAgIPDxYCHwEFBDIwMThkGAEFHl9fQ29udHJvbHNSZXF1aXJlUG9zdEJhY2tLZXlfXxYBBRljdGwwMCR1eEhlYWRlciR1eExvZ2luSW1nNYJwnStqazQnM8sudPgquMuqJJ4=',
    __VIEWSTATEGENERATOR: 'DEE52386',
    __EVENTVALIDATION: '/wEdAAn1yBu9Btkd6xzHAVkImOPmlWvBJAe1HI8ZSfy9T0VkSpOvawgEXWG/s6sgsnyFynPkgvH1Kg4LN23HnR3IXACbO0JWXv6tBEJgMVemNIyw0XYgfWVLH8Jr340y3cwZmyBymvxq4booWyuXnX6oEgklwf9sjnUNcWZG4cpRukWjQrmtGnnA8m02EiMAldqVbELAksiLiQbQyG/fsXAUF1PmE2VXeQ==',
    ctl00$uxContentPlaceHolder$browser_name: 'Chrome',
    ctl00$uxContentPlaceHolder$uxUsername: '',
    ctl00$uxContentPlaceHolder$uxPassword: '',
    ctl00$uxContentPlaceHolder$uxLogin: 'Login'
}

let balanceForm = {
    __LASTFOCUS: '',
    __EVENTTARGET: 'ctl00$uxContentPlaceHolder$uxTimer',
    __EVENTARGUMENT: '',
    __VIEWSTATE: '/wEPDwUKLTM3NTM2NDQ1Ng9kFgJmD2QWAgIDD2QWAgIBD2QWDAIBD2QWEmYPFgIeBGhyZWYFC34vaG9tZS5hc3B4ZAICDw8WAh4EVGV4dAUPTXkgbXlraSBhY2NvdW50ZGQCAw9kFgRmDw9kFgIeCW9ua2V5ZG93bgVWRW5hYmxlRW50ZXIoKHdpbmRvdy5ldmVudCkgPyB3aW5kb3cuZXZlbnQgOiBhcmd1bWVudHNbMF0sJ2N0bDAwX3V4SGVhZGVyX2N0bDAwX2N0bDAwJylkAgIPEGRkFgFmZAIEDxYCHgdvbmNsaWNrBRF7cmV0dXJuIFByaW50KCk7fWQCBQ8WBB4FdGl0bGUFC0xhcmdlciBUZXh0HwMFFntyZXR1cm4gbm9ybWFsRm9udCgpO31kAgYPDxYEHghJbWFnZVVybAUffi9JbmNsdWRlL0ltYWdlcy9pY29uTG9nb3V0LmdpZh4HVG9vbFRpcAUUQ2xpY2sgaGVyZSB0byBsb2dvdXRkZAIHDw8WAh8BBS1MYXN0IGxvZ2luIDogU2F0dXJkYXkgOCBTZXB0ZW1iZXIgMTE6MjQmbmJzcDtkZAIIDxYCHgdWaXNpYmxlaGQCCQ9kFgICAQ8WAh4Dc3JjBSB+L0luY2x1ZGUvSW1hZ2VzL215X2FjY291bnRzLmpwZ2QCBQ9kFgICARA8KwANAgAPFgIeC18hRGF0YUJvdW5kZ2QMFCsACgUjMDowLDA6MSwwOjIsMDozLDA6NCwwOjUsMDo2LDA6NywwOjgUKwACFg4fAQUESG9tZR4FVmFsdWUFBEhvbWUeC05hdmlnYXRlVXJsBQt+L0hvbWUuYXNweB4HRW5hYmxlZGgeClNlbGVjdGFibGVnHghEYXRhUGF0aAUgLypbcG9zaXRpb24oKT0xXS8qW3Bvc2l0aW9uKCk9MV0eCURhdGFCb3VuZGdkFCsAAhYOHwEFD0hvdyB0byB1c2UgbXlraR8KBQ9Ib3cgdG8gdXNlIG15a2kfCwUhfi8uLi9Ib3ctdG8tdXNlLW15a2kvZGVmYXVsdC5hc3B4HwxoHw1nHw4FIC8qW3Bvc2l0aW9uKCk9MV0vKltwb3NpdGlvbigpPTJdHw9nFCsABwUXMDowLDA6MSwwOjIsMDozLDA6NCwwOjUUKwACFg4fAQUKQWJvdXQgbXlraR8KBQpBYm91dCBteWtpHwsFLH4vLi4vSG93LXRvLXVzZS1teWtpL0Fib3V0LW15a2kvZGVmYXVsdC5hc3B4HwxoHw1nHw4FMC8qW3Bvc2l0aW9uKCk9MV0vKltwb3NpdGlvbigpPTJdLypbcG9zaXRpb24oKT0xXR8PZ2QUKwACFg4fAQUKVXNpbmcgbXlraR8KBQpVc2luZyBteWtpHwsFLH4vLi4vSG93LXRvLXVzZS1teWtpL1VzaW5nLW15a2kvZGVmYXVsdC5hc3B4HwxoHw1nHw4FMC8qW3Bvc2l0aW9uKCk9MV0vKltwb3NpdGlvbigpPTJdLypbcG9zaXRpb24oKT0yXR8PZ2QUKwACFg4fAQUKVGhlIGZ1dHVyZR8KBQpUaGUgZnV0dXJlHwsFK34vY29tbW9uL0NNUy9UaGVGdXR1cmUuYXNweD9tZW51PVRoZSBmdXR1cmUfDGgfDWcfDgUwLypbcG9zaXRpb24oKT0xXS8qW3Bvc2l0aW9uKCk9Ml0vKltwb3NpdGlvbigpPTNdHw9nZBQrAAIWDh8BBRRNYWtpbmcgbXlraSB5b3VyIGtleR8KBRRNYWtpbmcgbXlraSB5b3VyIGtleR8LBTZ+Ly4uL0hvdy10by11c2UtbXlraS9NYWtpbmctbXlraS15b3VyLWtleS9kZWZhdWx0LmFzcHgfDGgfDWcfDgUwLypbcG9zaXRpb24oKT0xXS8qW3Bvc2l0aW9uKCk9Ml0vKltwb3NpdGlvbigpPTRdHw9nZBQrAAIWDh8BBRZIZWxwZnVsIHRpcHMgYW5kIGhpbnRzHwoFFkhlbHBmdWwgdGlwcyBhbmQgaGludHMfCwU4fi8uLi9Ib3ctdG8tdXNlLW15a2kvSGVscGZ1bC10aXBzLWFuZC1oaW50cy9kZWZhdWx0LmFzcHgfDGgfDWcfDgUwLypbcG9zaXRpb24oKT0xXS8qW3Bvc2l0aW9uKCk9Ml0vKltwb3NpdGlvbigpPTVdHw9nZBQrAAIWDh8BBQlBYm91dCBUVEEfCgUJQWJvdXQgVFRBHwsFK34vLi4vSG93LXRvLXVzZS1teWtpL0Fib3V0LVRUQS9kZWZhdWx0LmFzcHgfDGgfDWcfDgUwLypbcG9zaXRpb24oKT0xXS8qW3Bvc2l0aW9uKCk9Ml0vKltwb3NpdGlvbigpPTZdHw9nZBQrAAIWDh8BBQhHZXQgbXlraR8KBQhHZXQgbXlraR8LBTF+L0NvbW1vbi9nZXRteWtpL0dldE15a2lPcHRpb24uYXNweD9tZW51PUdldCBteWtpHwxnHw1nHw4FIC8qW3Bvc2l0aW9uKCk9MV0vKltwb3NpdGlvbigpPTNdHw9nZBQrAAIWDh8BBQtTZXQgdXAgbXlraR8KBQtTZXQgdXAgbXlraR8LBTJ+L0NvbW1vbi9hdXhpbGxhcnkvc2V0dXBteWtpLmFzcHg/bWVudT1TZXQgdXAgbXlraR8MZx8NZx8OBSAvKltwb3NpdGlvbigpPTFdLypbcG9zaXRpb24oKT00XR8PZxQrAAMFBzA6MCwwOjEUKwACFg4fAQUIQWN0aXZhdGUfCgUIQWN0aXZhdGUfCwUyfi9Db21tb24vYXV4aWxsYXJ5L0FjdGl2YXRlQ2FyZC5hc3B4P21lbnU9QWN0aXZhdGUfDGgfDWcfDgUwLypbcG9zaXRpb24oKT0xXS8qW3Bvc2l0aW9uKCk9NF0vKltwb3NpdGlvbigpPTFdHw9nZBQrAAIWDh8BBQhSZWdpc3Rlch8KBQhSZWdpc3Rlch8LBTF+L0NvbW1vbi9yZWdpc3Rlci9yZWdpc3Rlcm15a2kuYXNweD9tZW51PVJlZ2lzdGVyHwxnHw1nHw4FMC8qW3Bvc2l0aW9uKCk9MV0vKltwb3NpdGlvbigpPTRdLypbcG9zaXRpb24oKT0yXR8PZ2QUKwACFg4fAQULVG9wIHVwIG15a2kfCgULVG9wIHVwIG15a2kfCwUufi9SZWdpc3RlcmVkL3RvcHVwL3RvcHVwLmFzcHg/bWVudT1Ub3AgdXAgbXlraR8MZx8NZx8OBSAvKltwb3NpdGlvbigpPTFdLypbcG9zaXRpb24oKT01XR8PZxQrAAQFCzA6MCwwOjEsMDoyFCsAAhYOHwEFDk9uZS1vZmYgdG9wIHVwHwoFDk9uZS1vZmYgdG9wIHVwHwsFN34vUmVnaXN0ZXJlZC90b3B1cC9DaG9vc2VUb3BVcC5hc3B4P21lbnU9T25lLW9mZiB0b3AgdXAfDGcfDWcfDgUwLypbcG9zaXRpb24oKT0xXS8qW3Bvc2l0aW9uKCk9NV0vKltwb3NpdGlvbigpPTFdHw9nZBQrAAIWDh8BBRJTZXQgdXAgYXV0byB0b3AgdXAfCgUSU2V0IHVwIGF1dG8gdG9wIHVwHwsFP34vUmVnaXN0ZXJlZC90b3B1cC9DaG9vc2VBdXRvVG9wVXAuYXNweD9tZW51PVNldCB1cCBhdXRvIHRvcCB1cB8MZx8NZx8OBTAvKltwb3NpdGlvbigpPTFdLypbcG9zaXRpb24oKT01XS8qW3Bvc2l0aW9uKCk9Ml0fD2dkFCsAAhYOHwEFEk1vZGlmeSBhdXRvIHRvcCB1cB8KBRJNb2RpZnkgYXV0byB0b3AgdXAfCwU/fi9SZWdpc3RlcmVkL3RvcHVwL01vZGlmeUF1dG9Ub3BVcC5hc3B4P21lbnU9TW9kaWZ5IGF1dG8gdG9wIHVwHwxnHw1nHw4FMC8qW3Bvc2l0aW9uKCk9MV0vKltwb3NpdGlvbigpPTVdLypbcG9zaXRpb24oKT0zXR8PZ2QUKwACFhAfAQUPTXkgbXlraSBhY2NvdW50HwoFD015IG15a2kgYWNjb3VudB8LBTR+L1JlZ2lzdGVyZWQvTXlNeWtpQWNjb3VudC5hc3B4P21lbnU9TXkgbXlraSBhY2NvdW50HwxnHw1nHw4FIC8qW3Bvc2l0aW9uKCk9MV0vKltwb3NpdGlvbigpPTZdHw9nHghTZWxlY3RlZGcUKwAMBSwwOjAsMDoxLDA6MiwwOjMsMDo0LDA6NSwwOjYsMDo3LDA6OCwwOjksMDoxMBQrAAIWDh8BBQ5NYW5hZ2UgbXkgY2FyZB8KBQ5NYW5hZ2UgbXkgY2FyZB8LBTJ+L1JlZ2lzdGVyZWQvTWFuYWdlTXlDYXJkLmFzcHg/bWVudT1NYW5hZ2UgbXkgY2FyZB8MZx8NZx8OBTAvKltwb3NpdGlvbigpPTFdLypbcG9zaXRpb24oKT02XS8qW3Bvc2l0aW9uKCk9MV0fD2dkFCsAAhYOHwEFD015IHRyYW5zYWN0aW9ucx8KBQ9NeSB0cmFuc2FjdGlvbnMfCwU5fi9SZWdpc3RlcmVkL01ZVHJhbnNhY3Rpb25zSW5mby5hc3B4P21lbnU9TXkgdHJhbnNhY3Rpb25zHwxnHw1nHw4FMC8qW3Bvc2l0aW9uKCk9MV0vKltwb3NpdGlvbigpPTZdLypbcG9zaXRpb24oKT0yXR8PZ2QUKwACFg4fAQUKTXkgZGV0YWlscx8KBQpNeSBkZXRhaWxzHwsFK34vUmVnaXN0ZXJlZC9NeURldGFpbHMuYXNweD9tZW51PU15IGRldGFpbHMfDGcfDWcfDgUwLypbcG9zaXRpb24oKT0xXS8qW3Bvc2l0aW9uKCk9Nl0vKltwb3NpdGlvbigpPTNdHw9nZBQrAAIWDh8BBRVSZWdpc3RlciBhbm90aGVyIG15a2kfCgUVUmVnaXN0ZXIgYW5vdGhlciBteWtpHwsFPn4vQ29tbW9uL3JlZ2lzdGVyL3JlZ2lzdGVybXlraS5hc3B4P21lbnU9UmVnaXN0ZXIgYW5vdGhlciBteWtpHwxnHw1nHw4FMC8qW3Bvc2l0aW9uKCk9MV0vKltwb3NpdGlvbigpPTZdLypbcG9zaXRpb24oKT00XR8PZ2QUKwACFg4fAQULTXkgcmVxdWVzdHMfCgULTXkgcmVxdWVzdHMfCwUtfi9SZWdpc3RlcmVkL015UmVxdWVzdHMuYXNweD9tZW51PU15IHJlcXVlc3RzHwxnHw1nHw4FMC8qW3Bvc2l0aW9uKCk9MV0vKltwb3NpdGlvbigpPTZdLypbcG9zaXRpb24oKT01XR8PZ2QUKwACFg4fAQUPQ2hhbmdlIHBhc3N3b3JkHwoFD0NoYW5nZSBwYXNzd29yZB8LBTV+L1JlZ2lzdGVyZWQvQ2hhbmdlUGFzc3dvcmQuYXNweD9tZW51PUNoYW5nZSBwYXNzd29yZB8MZx8NZx8OBTAvKltwb3NpdGlvbigpPTFdLypbcG9zaXRpb24oKT02XS8qW3Bvc2l0aW9uKCk9Nl0fD2dkFCsAAhYOHwEFCkNoYW5nZSBQSU4fCgUKQ2hhbmdlIFBJTh8LBS5+L1JlZ2lzdGVyZWQvTXlQaW5EZXRhaWxzLmFzcHg/bWVudT1DaGFuZ2UgUElOHwxnHw1nHw4FMC8qW3Bvc2l0aW9uKCk9MV0vKltwb3NpdGlvbigpPTZdLypbcG9zaXRpb24oKT03XR8PZ2QUKwACFg4fAQUVQ29udmVydCB0byBjb25jZXNzaW9uHwoFFUNvbnZlcnQgdG8gY29uY2Vzc2lvbh8LBUd+L1JlZ2lzdGVyZWQvUmVuZXdhbENvbmNlc3Npb24uYXNweD9tZW51PUNvbnZlcnQgdG8gY29uY2Vzc2lvbiZUeXBlPUNUQx8MaB8NZx8OBTAvKltwb3NpdGlvbigpPTFdLypbcG9zaXRpb24oKT02XS8qW3Bvc2l0aW9uKCk9OF0fD2dkFCsAAhYOHwEFEVJlbW92ZSBjb25jZXNzaW9uHwoFEVJlbW92ZSBjb25jZXNzaW9uHwsFP34vUmVnaXN0ZXJlZC9NeU15a2lSZW1vdmVDb25jZXNzaW9uLmFzcHg/bWVudT1SZW1vdmUgY29uY2Vzc2lvbh8MaB8NZx8OBTAvKltwb3NpdGlvbigpPTFdLypbcG9zaXRpb24oKT02XS8qW3Bvc2l0aW9uKCk9OV0fD2dkFCsAAhYOHwEFDUNsb3NlIGFjY291bnQfCgUNQ2xvc2UgYWNjb3VudB8LBTF+L1JlZ2lzdGVyZWQvQ2xvc2VBY2NvdW50LmFzcHg/bWVudT1DbG9zZSBhY2NvdW50HwxoHw1nHw4FMS8qW3Bvc2l0aW9uKCk9MV0vKltwb3NpdGlvbigpPTZdLypbcG9zaXRpb24oKT0xMF0fD2dkFCsAAhYOHwEFE01ha2UgbXlraSBhbm9ueW1vdXMfCgUTTWFrZSBteWtpIGFub255bW91cx8LBTx+L1JlZ2lzdGVyZWQvTWFrZU15a2lBbm9ueW1vdXMuYXNweD9tZW51PU1ha2UgbXlraSBhbm9ueW1vdXMfDGgfDWcfDgUxLypbcG9zaXRpb24oKT0xXS8qW3Bvc2l0aW9uKCk9Nl0vKltwb3NpdGlvbigpPTExXR8PZ2QUKwACFg4fAQUVQ2FyZC9BY2NvdW50IFJlcXVlc3RzHwoFFUNhcmQvQWNjb3VudCBSZXF1ZXN0cx8LBT5+L0NvbW1vbi9BdXhpbGxhcnkvRm9ybUxpYnJhcnkuYXNweD9tZW51PUNhcmQvQWNjb3VudCBSZXF1ZXN0cx8MZx8NZx8OBSAvKltwb3NpdGlvbigpPTFdLypbcG9zaXRpb24oKT03XR8PZxQrAAUFDzA6MCwwOjEsMDoyLDA6MxQrAAIWDh8BBRBBcHBseSBmb3IgcmVmdW5kHwoFEEFwcGx5IGZvciByZWZ1bmQfCwUcfi9SZWdpc3RlcmVkL1JlZnVuZG15a2kuYXNweB8MZx8NZx8OBTAvKltwb3NpdGlvbigpPTFdLypbcG9zaXRpb24oKT03XS8qW3Bvc2l0aW9uKCk9MV0fD2dkFCsAAhYOHwEFHFJlcG9ydCBhIGxvc3Qgb3Igc3RvbGVuIG15a2kfCgUcUmVwb3J0IGEgbG9zdCBvciBzdG9sZW4gbXlraR8LBUR+L1JlZ2lzdGVyZWQvUmVwb3J0TG9zdFN0b2xlbi5hc3B4P21lbnU9UmVwb3J0IGEgbG9zdCBvciBzdG9sZW4gbXlraR8MZx8NZx8OBTAvKltwb3NpdGlvbigpPTFdLypbcG9zaXRpb24oKT03XS8qW3Bvc2l0aW9uKCk9Ml0fD2dkFCsAAhYOHwEFF0FwcGx5IGZvciByZWltYnVyc2VtZW50HwoFF0FwcGx5IGZvciByZWltYnVyc2VtZW50HwsFI34vUmVnaXN0ZXJlZC9SZWltYnVyc2VtZW50bXlraS5hc3B4HwxnHw1nHw4FMC8qW3Bvc2l0aW9uKCk9MV0vKltwb3NpdGlvbigpPTddLypbcG9zaXRpb24oKT0zXR8PZ2QUKwACFg4fAQUMUmVwbGFjZSBteWtpHwoFDFJlcGxhY2UgbXlraR8LBR1+L1JlZ2lzdGVyZWQvUmVwbGFjZU15a2kuYXNweB8MZx8NZx8OBTAvKltwb3NpdGlvbigpPTFdLypbcG9zaXRpb24oKT03XS8qW3Bvc2l0aW9uKCk9NF0fD2dkFCsAAhYOHwEFE0NvbW11bml0eSBlZHVjYXRpb24fCgUTQ29tbXVuaXR5IGVkdWNhdGlvbh8LBSV+Ly4uL0NvbW11bml0eS1lZHVjYXRpb24vZGVmYXVsdC5hc3B4HwxoHw1nHw4FIC8qW3Bvc2l0aW9uKCk9MV0vKltwb3NpdGlvbigpPThdHw9nFCsABAULMDowLDA6MSwwOjIUKwACFg4fAQUWRGlzY292ZXJ5IGNlbnRyZSBkaWFyeR8KBRZEaXNjb3ZlcnkgY2VudHJlIGRpYXJ5HwsFSH4vY29tbW9uL0Rpc2NvdmVyeS9EaXNjb3ZlcnlDZW50ZXJEaWFyeS5hc3B4P21lbnU9RGlzY292ZXJ5IGNlbnRyZSBkaWFyeR8MZx8NZx8OBTAvKltwb3NpdGlvbigpPTFdLypbcG9zaXRpb24oKT04XS8qW3Bvc2l0aW9uKCk9MV0fD2dkFCsAAhYOHwEFGUJvb2sgdGhlIGRpc2NvdmVyeSBjZW50cmUfCgUZQm9vayB0aGUgZGlzY292ZXJ5IGNlbnRyZR8LBUp+L2NvbW1vbi9EaXNjb3ZlcnkvQm9va0Rpc2NvdmVyeUNlbnRlci5hc3B4P21lbnU9Qm9vayB0aGUgZGlzY292ZXJ5IGNlbnRyZR8MZx8NZx8OBTAvKltwb3NpdGlvbigpPTFdLypbcG9zaXRpb24oKT04XS8qW3Bvc2l0aW9uKCk9Ml0fD2dkFCsAAhYOHwEFJUZ1dHVyZSBtb2JpbGUgZGlzY292ZXJ5IGNlbnRyZSB2aXNpdHMfCgUlRnV0dXJlIG1vYmlsZSBkaXNjb3ZlcnkgY2VudHJlIHZpc2l0cx8LBVN+L2NvbW1vbi9EaXNjb3ZlcnkvVmlld0Z1dHVyZVZpc2l0cy5hc3B4P21lbnU9RnV0dXJlIG1vYmlsZSBkaXNjb3ZlcnkgY2VudHJlIHZpc2l0cx8MZx8NZx8OBTAvKltwb3NpdGlvbigpPTFdLypbcG9zaXRpb24oKT04XS8qW3Bvc2l0aW9uKCk9M10fD2dkFCsAAhYOHwEFCkNvbnRhY3QgdXMfCgUKQ29udGFjdCB1cx8LBTN+L0NvbW1vbi9BdXhpbGxhcnkvQ29udGFjdGluZm8uYXNweD9tZW51PUNvbnRhY3QgdXMfDGcfDWcfDgUgLypbcG9zaXRpb24oKT0xXS8qW3Bvc2l0aW9uKCk9OV0fD2cUKwAFBQ8wOjAsMDoxLDA6MiwwOjMUKwACFg4fAQUMQ29udGFjdCBteWtpHwoFDENvbnRhY3QgbXlraR8LBS9+L0NvbW1vbi9BdXhpbGxhcnkvQ29udGFjdHVzLmFzcHg/bWVudT1GZWVkYmFjax8MZx8NZx8OBTAvKltwb3NpdGlvbigpPTFdLypbcG9zaXRpb24oKT05XS8qW3Bvc2l0aW9uKCk9MV0fD2dkFCsAAhYOHwEFFENoZWNrIHN0YXR1cyByZXF1ZXN0HwoFFENoZWNrIHN0YXR1cyByZXF1ZXN0HwsFP34vQ29tbW9uL0F1eGlsbGFyeS9SZXF1ZXN0U3RhdHVzLmFzcHg/bWVudT1DaGVjayBzdGF0dXMgcmVxdWVzdB8MaB8NZx8OBTAvKltwb3NpdGlvbigpPTFdLypbcG9zaXRpb24oKT05XS8qW3Bvc2l0aW9uKCk9Ml0fD2dkFCsAAhYOHwEFC1Nwb25zb3JzaGlwHwoFC1Nwb25zb3JzaGlwHwsFKH4vLi4vQ29udGFjdC11cy9TcG9uc29yc2hpcC9kZWZhdWx0LmFzcHgfDGgfDWcfDgUwLypbcG9zaXRpb24oKT0xXS8qW3Bvc2l0aW9uKCk9OV0vKltwb3NpdGlvbigpPTNdHw9nZBQrAAIWDh8BBQxPdXIgcGFydG5lcnMfCgUMT3VyIHBhcnRuZXJzHwsFKX4vLi4vQ29udGFjdC11cy9PdXItcGFydG5lcnMvZGVmYXVsdC5hc3B4HwxoHw1nHw4FMC8qW3Bvc2l0aW9uKCk9MV0vKltwb3NpdGlvbigpPTldLypbcG9zaXRpb24oKT00XR8PZ2RkZAIJD2QWBAIDD2QWAmYPZBYMAgMPDxYCHwEFDkFjY291bnQgSG9sZGVyZGQCBQ8PFgIfAQUKQWhtZWQgQWRhbWRkAgcPDxYCHwdoZGQCCQ8WAh8BBdECPCEtLSBHZW5lcmF0ZWQgYnkgWFN0YW5kYXJkIHZlcnNpb24gMi4wLjAuMCBvbiAyMDEyLTA3LTMwVDE2OjMwOjIxIC0tPjxwPllvdSBjYW4gbWFuYWdlIHlvdXIgbXlraSBhY2NvdW50IGFuZCBhc3NvY2lhdGVkIG15a2kgY2FyZHMgb25saW5lIGFzIGVhc2lseSBhcyBjbGlja2luZyBhIG1vdXNlLiA8L3A+PHA+WW91ciBteWtpIG9ubGluZSBhY2NvdW50IGZ1bmN0aW9ucyBjYW4gYmUgYWNjZXNzZWQgdmlhIHRoZSBsZWZ0IG1lbnUgYW5kIGluY2x1ZGUgY2hhbmdpbmcgY29udGFjdCBkZXRhaWxzLCBzdXNwZW5kaW5nIG9yIGNhbmNlbGxpbmcgeW91ciBteWtpIGFuZCBtdWNoIG1vcmUuPC9wPmQCEQ88KwARAgEQFgAWABYADBQrAABkAhkPPCsAEQIBEBYAFgAWAAwUKwAAZAIHDxYCHwEF8QI8IS0tIEdlbmVyYXRlZCBieSBYU3RhbmRhcmQgdmVyc2lvbiAyLjAuMC4wIG9uIDIwMTItMDctMzBUMTY6MzI6NTYgLS0+PHA+PGI+Tk9URTo8L2I+IFlvdXIgbXlraSBtb25leSwgbXlraSBwYXNzIG9yIGF1dG8gdG9wIHVwIHdpbGwgYmUgdHJhbnNmZXJyZWQgdG8geW91ciBteWtpIHRoZSBuZXh0IHRpbWUgeW91IHByZXNlbnQgeW91ciBjYXJkIHRvIGEgbXlraSByZWFkZXIuPC9wPjxwPkNhcmRzIGluIHVzZSBhcmUgdGhlIE15a2kgY2FyZHMgdGhhdCBhcmUgYWN0aXZlIG9yIHRoYXQgaGF2ZSBiZWVuIGJsb2NrZWQuIEFyY2hpdmVkIGNhcmRzIGFyZSB0aGUgbXlraSBjYXJkcyB0aGF0IGhhdmUgYmVlbiByZWZ1bmRlZCBvciByZXBsYWNlZDwvcD5kAgsPZBYCAgEPFgIfAQXlATwhLS0gR2VuZXJhdGVkIGJ5IFhTdGFuZGFyZCB2ZXJzaW9uIDIuMC4wLjAgb24gMjAxMy0xMC0yOVQxMjoyMTo1MyAtLT48cD48aW1nIGFsdD0iWW91J3JlIGFsd2F5cyByZWFkeSB0byB0cmF2ZWwgd2l0aCBteWtpIGF1dG8gdG9wIHVwLiIgaGVpZ2h0PSIyOTkiIGlkPSJpbWdfQWR2ZXJ0aXNlIiBydW5hdD0ic2VydmVyIiBzcmM9Im15a2ktQXV0by1Ub3AtVXAuanBnIiB3aWR0aD0iMTM2IiAvPjwvcD5kAg0PZBYCAgEPDxYCHwdoZBYKZg8PFgIfAWVkZAICDxBkZBYBZmQCBA8PZBYCHwMFIXtyZXR1cm4gZ2V0Q29tYW5kTmFtZSgnVXBkYXRlJyk7fWQCBQ8PZBYCHwMFIXtyZXR1cm4gZ2V0Q29tYW5kTmFtZSgnU3VibWl0Jyk7fWQCBg8PZBYCHwMFJ3tyZXR1cm4gQ29uZmlybU5ld1NlYXJjaCgnTmV3U2VhcmNoJyk7fWQCDw9kFgICAQ9kFgICDw8WAh8BBQQyMDE4ZBgEBR5fX0NvbnRyb2xzUmVxdWlyZVBvc3RCYWNrS2V5X18WAQUZY3RsMDAkdXhIZWFkZXIkdXhMb2dpbkltZwUpY3RsMDAkdXhDb250ZW50UGxhY2VIb2xkZXIkZ3ZBcmNoaXZlQ2FyZHMPZ2QFJGN0bDAwJHV4Q29udGVudFBsYWNlSG9sZGVyJHV4TXlDYXJkcw9nZAUhY3RsMDAkdXhNYWluTmF2aWdhdGlvbiR1eE1haW5NZW51Dw9kBQ9NeSBteWtpIGFjY291bnRk7ExnIhkKqVaFI0F828f22FrIEpQ=',
    __VIEWSTATEGENERATOR: '9B3DD0B4',
    __EVENTVALIDATION: '/wEdAAU+ifqj388RwDZr6fbEmE2YlWvBJAe1HI8ZSfy9T0VkSpOvawgEXWG/s6sgsnyFynPkgvH1Kg4LN23HnR3IXACbO0JWXv6tBEJgMVemNIyw0VexTRqJIoGrdzVbWAsuWvTsGxNA',
    _ASYNCPOST: 'true',
    ctl00$uxHeader$uxSearchTextBox: '',
    ctl00$uxHeader$hidFontSize: '',
    ctl00$ScriptManager1: 'ctl00$uxContentPlaceHolder$Panel|ctl00$uxContentPlaceHolder$uxTimer'
}

let loginOptions = {
    uri: `https://www.mymyki.com.au/ntswebportal/login.aspx`,
    form: loginForm,
    method: 'POST',
    simple: false,
    followAllRedirects: true,
    resolveWithFullResponse: true
};

let balanceOptions = {
    uri: `https://www.mymyki.com.au/NTSWebPortal/Registered/MyMykiAccount.aspx?menu=My+myki+account`,
    form: balanceForm,
    method: 'POST',
    simple: false,
    followAllRedirects: true,
    transform: function(body) {
        return cheerio.load(body);
    }
}

async function checkBalance(username, password) {
    try {
        loginForm["ctl00$uxContentPlaceHolder$uxUsername"] = username;
        loginForm["ctl00$uxContentPlaceHolder$uxPassword"] = password;
    const cookieJar = rp.jar();

        let login = await rp(loginOptions);
    
        let redirectUrl = login.request.uri.pathname;
        const success = '/NTSWebPortal/Registered/MyMykiAccount.aspx';
        const fail = '/ntswebportal/login.aspx';
    
        if (redirectUrl == success) {
            const $ = await rp(balanceOptions);
            let result = $('#ctl00_uxContentPlaceHolder_uxMyCards > tbody > tr:nth-child(2) > td:nth-child(3)').text().trim();
            
            return result;
    loginOptions.jar = cookieJar;
    balanceOptions.jar = cookieJar;
        
        } else if (redirectUrl == fail) {
            throw new Error('Login failed');
        }

    } catch(e) {
        console.error(e);
    }
}

module.exports = {
	checkBalance: checkBalance
}